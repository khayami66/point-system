# ロードマップ：ごほうびポイント管理Bot

このドキュメントでは、今後の機能拡張計画を整理します。

---

## 現在のステータス（v1）

- 基本的な行動記録機能（宿題、スタスタ、早寝、お手伝い）
- 今日のポイント確認
- ごほうび状況確認
- ごほうび達成時の自動通知
- 単一ユーザー（child_01）のみ対応
- Google Sheets でデータ管理

---

## フェーズ1: 基本機能の強化（個人利用の改善）

**目的**: 日常的に使いやすくする

| 機能 | 説明 | 優先度 | ステータス |
|------|------|--------|------------|
| ポイント取り消し | 「取り消し」で直前の記録を削除 | 高 | 未着手 |
| 行動マスタの外部化 | スプレッドシートの actions シートから行動を読み込み | 高 | 未着手 |
| 複数ごほうび閾値 | 50pt, 100pt, 200pt など段階的なごほうび設定 | 中 | 未着手 |
| 週間レポート | 「今週のポイント」で週間集計を表示 | 中 | 未着手 |
| 月間レポート | 「今月のポイント」で月間集計を表示 | 低 | 未着手 |

### 実装メモ

**ポイント取り消し機能**
- 「取り消し」「キャンセル」などのキーワードで発動
- 直前の記録を records シートから削除
- ステータスのポイントも減算

**行動マスタの外部化**
- actions シートのフォーマット: action, keywords, points
- アプリ起動時または定期的にシートを読み込み
- スプレッドシート上で行動の追加・変更・削除が可能に

---

## フェーズ2: 複数ユーザー対応（家族内での利用）

**目的**: 複数の子どもを管理できるようにする

| 機能 | 説明 | 優先度 | ステータス |
|------|------|--------|------------|
| 複数の子ども対応 | 「たろう：宿題」のように名前指定で記録 | 高 | 未着手 |
| ユーザー切り替え | 「たろうに切り替え」でデフォルトユーザーを変更 | 中 | 未着手 |
| ユーザー一覧表示 | 「メンバー」で登録済みの子ども一覧を表示 | 中 | 未着手 |
| 親専用コマンド | 「管理：ポイント修正」など管理者向け機能 | 中 | 未着手 |
| 全員の状況確認 | 「みんなのポイント」で全員分を一括表示 | 低 | 未着手 |

### 実装メモ

**複数の子ども対応**
- children シートを新設: child_id, name, created_at
- メッセージ形式: 「{名前}：{行動}」または「{名前} {行動}」
- 名前が省略された場合はデフォルトユーザーを使用

**ユーザー切り替え**
- LINE ユーザーごとにデフォルトの child_id を記憶
- user_settings シートを新設: line_user_id, default_child_id

---

## フェーズ3: マルチテナント化（他の家庭でも利用可能に）

**目的**: 複数の家庭が独立してサービスを利用できるようにする

| 機能 | 説明 | 優先度 | ステータス |
|------|------|--------|------------|
| LINE ログイン連携 | 家庭ごとにデータを分離 | 高 | 未着手 |
| 初期設定フロー | 友だち追加時に自動でデータ領域を作成 | 高 | 未着手 |
| 行動カスタマイズ | 各家庭が独自の行動とポイントを設定 | 中 | 未着手 |
| データベース移行 | Google Sheets → PostgreSQL / Supabase | 中 | 未着手 |
| 管理画面（Web） | ブラウザから設定変更できるUI | 低 | 未着手 |

### 実装メモ

**LINE ログイン連携**
- LINE ユーザーID をキーにして家庭を識別
- 各家庭ごとに独立したデータ領域を持つ

**データベース移行**
- Google Sheets はスケーラビリティに限界がある
- PostgreSQL（Render / Supabase）への移行を検討
- ORM として SQLAlchemy を使用

### 技術構成の変化

```
現在（v1）              フェーズ3以降
────────────────────────────────────────────
Google Sheets      →    PostgreSQL / Supabase
コード内定数        →    データベースでマスタ管理
単一ユーザー        →    LINE ログインで認証
Render Free        →    Render Paid / AWS / GCP
```

---

## フェーズ4: 公開・収益化

**目的**: 一般公開し、持続可能なサービスにする

| 項目 | 説明 | 優先度 | ステータス |
|------|------|--------|------------|
| プライバシーポリシー | 個人情報の取り扱いを明記 | 高 | 未着手 |
| 利用規約 | サービス利用条件を定義 | 高 | 未着手 |
| ランディングページ | サービス紹介ページを作成 | 中 | 未着手 |
| 有料プラン | 高機能版を月額課金（Stripe連携） | 低 | 未着手 |
| 分析基盤 | 利用状況のモニタリング | 低 | 未着手 |

### 収益化モデル案

**フリーミアムモデル**
- 無料プラン: 基本機能、子ども1人まで
- 有料プラン: 複数の子ども、詳細レポート、行動カスタマイズ無制限

---

## おすすめの進め方

1. **フェーズ1から着手** - 現在の技術構成のまま実装可能
2. **実際に使いながら改善** - 自分の家庭で使い続けてフィードバックを得る
3. **需要を確認してからフェーズ3へ** - マルチテナント化は工数が大きいため

---

## 更新履歴

| 日付 | 内容 |
|------|------|
| 2025-12-03 | 初版作成 |
